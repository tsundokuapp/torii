services:
  torii-auth-api:
    image: ${DOCKER_IMAGE:-tsundokuapp/torii-auth-api:latest}
    container_name: torii-auth-api
    restart: unless-stopped
    ports:
      - "8080:8080"
    environment:
      - ASPNETCORE_ENVIRONMENT=${ASPNETCORE_ENVIRONMENT:-Production}
      - ASPNETCORE_URLS=http://+:8080
      # Banco de Dados
      - ConnectionStrings__UsuarioConnection=${DATABASE_CONNECTION_STRING}
      # JWT
      - JwtConfiguration__SecretToken=${JWT_SECRET_TOKEN}
      - JwtConfiguration__SecretTokenReset=${JWT_SECRET_TOKEN_RESET}
      - JwtConfiguration__RefreshTokenValidityInMinutes=${JWT_REFRESH_TOKEN_MINUTES:-10080}
      - JwtConfiguration__ResetTokenValidityInMinutes=${JWT_RESET_TOKEN_MINUTES:-15}
      # Email SMTP
      - AcessoEmail__SmtpServer=${SMTP_SERVER}
      - AcessoEmail__Remetente=${SMTP_REMETENTE}
      - AcessoEmail__Password=${SMTP_PASSWORD}
      - AcessoEmail__Port=${SMTP_PORT:-465}
      - AcessoEmail__EmailAdminInicial=${ADMIN_EMAIL}
      - AcessoEmail__SenhaAdminInicial=${ADMIN_PASSWORD}
      # URLs de Integração
      - IntegrationUrlBase__UrlBaseTsundokuApi=${INTEGRATION_URL_API}
      - IntegrationUrlBase__UrlBaseTsundokuWeb=${INTEGRATION_URL_WEB}
      # CORS
      - Cors__AllowedOrigins__0=${CORS_ALLOWED_ORIGINS:-http://localhost:3000}
    volumes:
      - dataprotection_keys:/app/keys

volumes:
  dataprotection_keys:
